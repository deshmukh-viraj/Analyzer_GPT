import subprocess
import os

try:
    # Attempt to import pandas
    import pandas as pd
except ImportError:
    # If pandas is not found, install it using pip
    print("pandas not found. Installing...")
    try:
        subprocess.check_call(["python", "-m", "pip", "install", "pandas"])
        # Now try importing pandas again
        import pandas as pd
        print("pandas installed successfully.")
    except subprocess.CalledProcessError as e:
        print(f"Error installing pandas: {e}")
        print("Task failed: Could not install pandas.")
        exit()
    except ImportError:
        print("Error: Could not import pandas after installation.")
        print("Task failed: Could not import pandas.")
        exit()

# Get the list of files in the temp directory
files = os.listdir("temp")

# Assuming there's only one CSV file in the directory
csv_file = next((f for f in files if f.endswith('.csv')), None)

if csv_file:
    try:
        # Read the CSV file into a pandas DataFrame
        df = pd.read_csv(os.path.join("temp", csv_file))

        # Get the number of rows and columns
        num_rows, num_columns = df.shape

        # Print the number of rows and columns
        print(f"The CSV file has {num_rows} rows and {num_columns} columns.")
        print("Task completed: Number of rows and columns determined and printed.")

    except FileNotFoundError:
        print("Error: The specified CSV file was not found.")
        print("Task failed: CSV file not found.")
    except Exception as e:
        print(f"An error occurred: {e}")
        print("Task failed: An error occurred during processing.")
else:
    print("Error: No CSV file found in the directory.")
    print("Task failed: No CSV file found.")
